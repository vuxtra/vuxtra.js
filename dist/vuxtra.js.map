{"version":3,"file":"vuxtra.js","sources":["../lib/common/options.js","../node_modules/tapable/lib/Hook.js","../node_modules/tapable/lib/simpleAsyncCases.js","../node_modules/tapable/lib/AsyncParallelHook.js","../lib/vuxtraBoot.js"],"sourcesContent":["import _ from 'lodash'\nimport { join, resolve } from 'path'\n\nlet defaultOptionsObj = {\n    'nuxt': {},\n    'socketcluster': {\n        workers: Number(process.env.SOCKETCLUSTER_WORKERS) || 1,\n        brokers: Number(process.env.SOCKETCLUSTER_BROKERS) || 1,\n        port:  Number(process.env.SOCKETCLUSTER_PORT) || 3000,\n        // If your system doesn't support 'uws', you can switch to 'ws' (which is slower but works on older systems).\n        wsEngine: process.env.SOCKETCLUSTER_WS_ENGINE || 'uws',\n        appName: process.env.SOCKETCLUSTER_APP_NAME || null,\n        workerController: __dirname + '/sccWorker.js',\n        brokerController: __dirname + '/sccBroker.js',\n        initController: process.env.SOCKETCLUSTER_INIT_CONTROLLER || null,\n        workerClusterController: process.env.SOCKETCLUSTER_WORKERCLUSTER_CONTROLLER || null,\n        socketChannelLimit: Number(process.env.SOCKETCLUSTER_SOCKET_CHANNEL_LIMIT) || 1000,\n        clusterStateServerHost: process.env.SCC_STATE_SERVER_HOST || null,\n        clusterStateServerPort: process.env.SCC_STATE_SERVER_PORT || null,\n        clusterAuthKey: process.env.SCC_AUTH_KEY || null,\n        clusterInstanceIp: process.env.SCC_INSTANCE_IP || null,\n        clusterInstanceIpFamily: process.env.SCC_INSTANCE_IP_FAMILY || null,\n        clusterStateServerConnectTimeout: Number(process.env.SCC_STATE_SERVER_CONNECT_TIMEOUT) || null,\n        clusterStateServerAckTimeout: Number(process.env.SCC_STATE_SERVER_ACK_TIMEOUT) || null,\n        clusterStateServerReconnectRandomness: Number(process.env.SCC_STATE_SERVER_RECONNECT_RANDOMNESS) || null,\n        crashWorkerOnError: false,\n        // If using nodemon, set this to true, and make sure that environment is 'dev'.\n        killMasterOnSignal: false,\n        environment: process.env.ENV || 'dev'\n    },\n    'vuxtra': {\n        dev: process.env.NODE_ENV !== 'production',\n        debug: undefined, // Will be equal to dev if not provided\n        buildDir: '.vuxtra',\n        cacheDir: '.vuxtracache',\n        build: {\n            analyze: false,\n            dll: false,\n            extractCSS: false,\n            cssSourceMap: undefined,\n            ssr: undefined,\n            filenames: {\n                css: 'common.[contenthash].css',\n                manifest: 'manifest.[hash].js',\n                vendor: 'common.[chunkhash].js',\n                app: 'app.[chunkhash].js',\n                chunk: '[name].[chunkhash].js'\n            },\n            plugins: [],\n            babel: {},\n            watch: [],\n            devMiddleware: {},\n            hotMiddleware: {}\n        },\n        plugins: [],\n        watchers: {\n            webpack: {\n                ignored: /-dll/\n            },\n            chokidar: {}\n        },\n    }\n}\n\nconst Options = {}\n\nOptions.from = function (_options) {\n    const options = Object.assign({}, _options)\n\n    _.defaultsDeep(options, defaultOptions)\n\n    // let's check and make sure we set srcDir defaults\n    if (typeof options.vuxtra.srcDir === 'undefined' || options.vuxtra.srcDir === null) {\n        if (typeof options.rootDir !== 'undefined') {\n            // if vuxtra srcdir not provider we set it to root one\n            options.vuxtra.srcDir = options.rootDir\n        }\n    }\n\n    // Resolve dirs\n    const hasValue = v => typeof v === 'string' && v\n    options.vuxtra.rootDir = hasValue(options.vuxtra.rootDir) ? options.vuxtra.rootDir : (options.rootDir ? options.rootDir : process.cwd())\n    options.vuxtra.srcDir = hasValue(options.vuxtra.srcDir) ? resolve(options.vuxtra.rootDir, options.vuxtra.srcDir) : options.vuxtra.rootDir\n    options.vuxtra.modulesDir = resolve(options.vuxtra.rootDir, hasValue(options.vuxtra.modulesDir) ? options.vuxtra.modulesDir : 'node_modules')\n    options.vuxtra.buildDir = resolve(options.vuxtra.rootDir, options.vuxtra.buildDir)\n    options.vuxtra.cacheDir = resolve(options.vuxtra.rootDir, options.vuxtra.cacheDir)\n\n    return options\n\n}\n\nexport const defaultOptions = defaultOptionsObj\n\nexport default Options","/*\r\n\tMIT License http://www.opensource.org/licenses/mit-license.php\r\n\tAuthor Tobias Koppers @sokra\r\n*/\r\n\"use strict\";\r\n\r\nclass Hook {\r\n\tconstructor(args) {\r\n\t\tif(!Array.isArray(args)) args = [];\r\n\t\tthis._args = args;\r\n\t\tthis.taps = [];\r\n\t\tthis.interceptors = [];\r\n\t\tthis.call = this._call = this.createCompileDelegate(\"call\", \"sync\", args);\r\n\t\tthis.promise = this._promise = this.createCompileDelegate(\"promise\", \"promise\", args);\r\n\t\tthis.callAsync = this._callAsync = this.createCompileDelegate(\"callAsync\", \"async\", args.concat(\"_callback\"));\r\n\t\tthis._x = undefined;\r\n\t}\r\n\r\n\tcompile(options) {\r\n\t\tconst source = this.template(options);\r\n\t\treturn new Function(`\"use strict\"; return (${source});`)();\r\n\t}\r\n\r\n\tgetTapType() {\r\n\t\tif(this.interceptors.length > 0) return \"intercept\";\r\n\t\tif(this.taps.length === 0) return \"none\";\r\n\t\tif(this.taps.length === 1) {\r\n\t\t\tconst tap = this.taps[0];\r\n\t\t\treturn tap.type;\r\n\t\t}\r\n\t\tlet type = this.taps[0].type;\r\n\t\tfor(let i = 1; i < this.taps.length; i++) {\r\n\t\t\tconst tap = this.taps[i];\r\n\t\t\tif(tap.type !== type) return \"multiple\";\r\n\t\t}\r\n\t\treturn \"multiple-\" + type;\r\n\t}\r\n\r\n\tcreateCall(type) {\r\n\t\tconst tap = this.getTapType();\r\n\t\tif(tap === \"sync\" || tap === \"async\" || tap === \"promise\")\r\n\t\t\tthis._x = this.taps[0].fn;\r\n\t\telse if(tap === \"multiple-sync\" || tap === \"multiple-async\" || tap === \"multiple-promise\")\r\n\t\t\tthis._x = this.taps.map(t => t.fn);\r\n\t\telse\r\n\t\t\tthis._x = this.taps;\r\n\t\treturn this.compile({\r\n\t\t\targs: this._args,\r\n\t\t\ttap: tap,\r\n\t\t\ttype: type\r\n\t\t});\r\n\t}\r\n\r\n\tcreateCompileDelegate(name, type, args) {\r\n\t\treturn new Function(args, `\r\n\t\t\tthis.${name} = this.createCall(${JSON.stringify(type)});\r\n\t\t\treturn this.${name}(${args.join(\", \")});\r\n\t\t`);\r\n\t}\r\n\r\n\ttap(options, fn) {\r\n\t\tif(typeof options === \"string\")\r\n\t\t\toptions = { name: options };\r\n\t\tif(typeof options !== \"object\" || options === null)\r\n\t\t\tthrow new Error(\"Invalid arguments to tap(options: Object, fn: function)\");\r\n\t\toptions = Object.assign({ type: \"sync\", fn: fn }, options);\r\n\t\tif(typeof options.name !== \"string\" || options.name === \"\")\r\n\t\t\tthrow new Error(\"Missing name for tap\");\r\n\t\tthis._insert(options);\r\n\t}\r\n\r\n\ttapAsync(options, fn) {\r\n\t\tif(typeof options === \"string\")\r\n\t\t\toptions = { name: options };\r\n\t\tif(typeof options !== \"object\" || options === null)\r\n\t\t\tthrow new Error(\"Invalid arguments to tapAsync(options: Object, fn: function)\");\r\n\t\toptions = Object.assign({ type: \"async\", fn: fn }, options);\r\n\t\tif(typeof options.name !== \"string\" || options.name === \"\")\r\n\t\t\tthrow new Error(\"Missing name for tapAsync\");\r\n\t\tthis._insert(options);\r\n\t}\r\n\r\n\ttapPromise(options, fn) {\r\n\t\tif(typeof options === \"string\")\r\n\t\t\toptions = { name: options };\r\n\t\tif(typeof options !== \"object\" || options === null)\r\n\t\t\tthrow new Error(\"Invalid arguments to tapPromise(options: Object, fn: function)\");\r\n\t\toptions = Object.assign({ type: \"promise\", fn: fn }, options);\r\n\t\tif(typeof options.name !== \"string\" || options.name === \"\")\r\n\t\t\tthrow new Error(\"Missing name for tapPromise\");\r\n\t\tthis._insert(options);\r\n\t}\r\n\r\n\twithOptions(options) {\r\n\t\tconst mergeOptions = opt => Object.assign({}, options, typeof opt === \"string\" ? { name: opt } : opt);\r\n\r\n\t\t// Prevent creating endless prototype chains\r\n\t\toptions = Object.assign({}, this._withOptions);\r\n\t\tconst base = this._withOptionsBase || this;\r\n\t\tconst newHook = Object.create(base);\r\n\r\n\t\tnewHook.tapAsync = (opt, fn) => base.tapAsync(mergeOptions(opt), fn),\r\n\t\tnewHook.tap = (opt, fn) => base.tap(mergeOptions(opt), fn);\r\n\t\tnewHook.tapPromise = (opt, fn) => base.tapPromise(mergeOptions(opt), fn);\r\n\t\tnewHook._withOptions = options;\r\n\t\tnewHook._withOptionsBase = options;\r\n\t\treturn newHook;\r\n\t}\r\n\r\n\tisUsed() {\r\n\t\treturn this.taps.length > 0 || this.interceptors.length > 0;\r\n\t}\r\n\r\n\tintercept(interceptor) {\r\n\t\tthis._resetCompilation();\r\n\t\tthis.interceptors.push(Object.assign({\r\n\t\t\tcall: () => {},\r\n\t\t\tloop: () => {},\r\n\t\t\ttap: tap => tap,\r\n\t\t}, interceptor));\r\n\t}\r\n\r\n\t_resetCompilation() {\r\n\t\tthis.call = this._call;\r\n\t\tthis.callAsync = this._callAsync;\r\n\t\tthis.promise = this._promise;\r\n\t}\r\n\r\n\t_insert(item) {\r\n\t\tthis._resetCompilation();\r\n\t\tlet before;\r\n\t\tif(typeof item.before === \"string\")\r\n\t\t\tbefore = new Set([item.before]);\r\n\t\telse if(Array.isArray(item.before)) {\r\n\t\t\tbefore = new Set(item.before);\r\n\t\t}\r\n\t\tlet stage = 0;\r\n\t\tif(typeof item.stage === \"number\")\r\n\t\t\tstage = item.stage;\r\n\t\tlet i = this.taps.length;\r\n\t\twhile(i > 0) {\r\n\t\t\ti--;\r\n\t\t\tconst x = this.taps[i];\r\n\t\t\tthis.taps[i+1] = x;\r\n\t\t\tconst xStage = x.stage || 0;\r\n\t\t\tif(before) {\r\n\t\t\t\tif(before.has(x.name)) {\r\n\t\t\t\t\tbefore.delete(x.name);\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tif(before.size > 0) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(xStage > stage) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\ti++;\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tthis.taps[i] = item;\r\n\t}\r\n}\r\n\r\nmodule.exports = Hook;\r\n","/*\r\n\tMIT License http://www.opensource.org/licenses/mit-license.php\r\n\tAuthor Tobias Koppers @sokra\r\n*/\r\n\"use strict\";\r\n\r\nexports.notBailing = (options) => {\r\n\tconst args = options.args.join(\", \");\r\n\tconst argsWithCallback = args ? `${args}, _callback` : \"_callback\";\r\n\tconst argsWithComma = args ? `${args}, ` : \"\";\r\n\tconst tap = options.tap;\r\n\tconst type = options.type;\r\n\tswitch(`${tap} ${type}`) {\r\n\t\tcase \"none async\":\r\n\t\t\treturn `function(${argsWithCallback}) {\r\n\t\t\t\t_callback();\r\n\t\t\t}`;\r\n\t\tcase \"none promise\":\r\n\t\t\treturn `function(${args}) {\r\n\t\t\t\treturn Promise.resolve();\r\n\t\t\t}`;\r\n\t\tcase \"sync async\":\r\n\t\t\treturn `function(${argsWithCallback}) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tthis._x(${args});\r\n\t\t\t\t} catch(_e) {\r\n\t\t\t\t\t_callback(_e);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t_callback();\r\n\t\t\t}`;\r\n\t\tcase \"sync promise\":\r\n\t\t\treturn `function(${args}) {\r\n\t\t\t\treturn Promise.resolve().then(() => {\r\n\t\t\t\t\tthis._x(${args});\r\n\t\t\t\t});\r\n\t\t\t}`;\r\n\t\tcase \"async async\":\r\n\t\t\treturn `function(${argsWithCallback}) {\r\n\t\t\t\tthis._x(${argsWithComma}(_err) => {\r\n\t\t\t\t\tif(_err) {\r\n\t\t\t\t\t\t_callback(_err);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_callback();\r\n\t\t\t\t});\r\n\t\t\t}`;\r\n\t\tcase \"async promise\":\r\n\t\t\treturn `function(${args}) {\r\n\t\t\t\treturn new Promise((_resolve, _reject) => {\r\n\t\t\t\t\tlet _isSync = true;\r\n\t\t\t\t\tthis._x(${argsWithComma}_err => {\r\n\t\t\t\t\t\tif(_err) {\r\n\t\t\t\t\t\t\tif(_isSync)\r\n\t\t\t\t\t\t\t\tPromise.resolve().then(() => _reject(_err));\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t_reject(_err);\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t_resolve();\r\n\t\t\t\t\t});\r\n\t\t\t\t\t_isSync = false;\r\n\t\t\t\t});\r\n\t\t\t}`;\r\n\t\tcase \"promise async\":\r\n\t\t\treturn `function(${argsWithCallback}) {\r\n\t\t\t\tPromise.resolve(this._x(${args})).then(() => {\r\n\t\t\t\t\t_callback();\r\n\t\t\t\t}, _err => {\r\n\t\t\t\t\t_callback(_err);\r\n\t\t\t\t});\r\n\t\t\t}`;\r\n\t\tcase \"promise promise\":\r\n\t\t\treturn `function(${args}) {\r\n\t\t\t\treturn Promise.resolve(this._x(${args})).then(() => {});\r\n\t\t\t}`;\r\n\t\tcase \"multiple-sync async\":\r\n\t\t\treturn `function(${argsWithCallback}) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst _fns = this._x;\r\n\t\t\t\t\tfor(let _i = 0; _i < _fns.length; _i++) {\r\n\t\t\t\t\t\t_fns[_i](${args});\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch(_err) {\r\n\t\t\t\t\t_callback(_err);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t_callback();\r\n\t\t\t}`;\r\n\t\tcase \"multiple-sync promise\":\r\n\t\t\treturn `function(${args}) {\r\n\t\t\t\treturn Promise.resolve().then(() => {\r\n\t\t\t\t\tconst _fns = this._x;\r\n\t\t\t\t\tfor(let _i = 0; _i < _fns.length; _i++) {\r\n\t\t\t\t\t\t_fns[_i](${args});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}`;\r\n\t}\r\n}\r\n\r\nexports.bailing = (options) => {\r\n\tconst args = options.args.join(\", \");\r\n\tconst argsWithCallback = args ? `${args}, _callback` : \"_callback\";\r\n\tconst argsWithComma = args ? `${args}, ` : \"\";\r\n\tconst tap = options.tap;\r\n\tconst type = options.type;\r\n\tswitch(`${tap} ${type}`) {\r\n\t\tcase \"none async\":\r\n\t\t\treturn `function(${argsWithCallback}) {\r\n\t\t\t\t_callback();\r\n\t\t\t}`;\r\n\t\tcase \"none promise\":\r\n\t\t\treturn `function(${args}) {\r\n\t\t\t\treturn Promise.resolve();\r\n\t\t\t}`;\r\n\t\tcase \"sync async\":\r\n\t\t\treturn `function(${argsWithCallback}) {\r\n\t\t\t\tlet _result;\r\n\t\t\t\ttry {\r\n\t\t\t\t\t_result = this._x(${args});\r\n\t\t\t\t} catch(_e) {\r\n\t\t\t\t\t_callback(_e);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t_callback(null, _result);\r\n\t\t\t}`;\r\n\t\tcase \"sync promise\":\r\n\t\t\treturn `function(${args}) {\r\n\t\t\t\treturn Promise.resolve().then(() => this._x(${args}));\r\n\t\t\t}`;\r\n\t\tcase \"async async\":\r\n\t\t\treturn `function(${argsWithCallback}) {\r\n\t\t\t\tthis._x(${argsWithCallback});\r\n\t\t\t}`;\r\n\t\tcase \"async promise\":\r\n\t\t\treturn `function(${args}) {\r\n\t\t\t\treturn new Promise((_resolve, _reject) => {\r\n\t\t\t\t\tlet _isSync = true;\r\n\t\t\t\t\tthis._x(${argsWithComma}(_err, _result) => {\r\n\t\t\t\t\t\tif(_err) {\r\n\t\t\t\t\t\t\tif(_isSync)\r\n\t\t\t\t\t\t\t\tPromise.resolve().then(() => _reject(_err));\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t_reject(_err);\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t_resolve(_result);\r\n\t\t\t\t\t});\r\n\t\t\t\t\t_isSync = false;\r\n\t\t\t\t});\r\n\t\t\t}`;\r\n\t\tcase \"promise async\":\r\n\t\t\treturn `function(${argsWithCallback}) {\r\n\t\t\t\tPromise.resolve(this._x(${args})).then(_result => {\r\n\t\t\t\t\t_callback(null, _result);\r\n\t\t\t\t}, _err => {\r\n\t\t\t\t\t_callback(_err);\r\n\t\t\t\t});\r\n\t\t\t}`;\r\n\t\tcase \"promise promise\":\r\n\t\t\treturn `function(${args}) {\r\n\t\t\t\treturn this._x(${args});\r\n\t\t\t}`;\r\n\t\tcase \"multiple-sync async\":\r\n\t\t\treturn `function(${argsWithCallback}) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst _fns = this._x;\r\n\t\t\t\t\tfor(let _i = 0; _i < _fns.length; _i++) {\r\n\t\t\t\t\t\tconst _result = _fns[_i](${args});\r\n\t\t\t\t\t\tif(_result !== undefined) {\r\n\t\t\t\t\t\t\t_callback(null, _result);\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch(_err) {\r\n\t\t\t\t\t_callback(_err);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t_callback();\r\n\t\t\t}`;\r\n\t\tcase \"multiple-sync promise\":\r\n\t\t\treturn `function(${args}) {\r\n\t\t\t\treturn new Promise(_resolve => {\r\n\t\t\t\t\tconst _fns = this._x;\r\n\t\t\t\t\tfor(let _i = 0; _i < _fns.length; _i++) {\r\n\t\t\t\t\t\tconst _result = _fns[_i](${args});\r\n\t\t\t\t\t\tif(_result !== undefined) {\r\n\t\t\t\t\t\t\t_resolve(_result);\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_resolve();\r\n\t\t\t\t});\r\n\t\t\t}`;\r\n\t}\r\n}\r\n","/*\r\n\tMIT License http://www.opensource.org/licenses/mit-license.php\r\n\tAuthor Tobias Koppers @sokra\r\n*/\r\n\"use strict\";\r\n\r\nconst Hook = require(\"./Hook\");\r\nconst simpleAsyncCases = require(\"./simpleAsyncCases\");\r\n\r\nclass AsyncParallelHook extends Hook {\r\n\tconstructor(args) {\r\n\t\tsuper(args);\r\n\t\tthis.call = this._call = undefined;\r\n\t}\r\n\r\n\ttemplate(options) {\r\n\t\tconst simpleCase = simpleAsyncCases.notBailing(options);\r\n\t\tif(simpleCase) return simpleCase;\r\n\t\tconst args = options.args.join(\", \");\r\n\t\tconst argsWithCallback = args ? `${args}, _callback` : \"_callback\";\r\n\t\tconst argsWithComma = args ? `${args}, ` : \"\";\r\n\t\tconst tap = options.tap;\r\n\t\tconst type = options.type;\r\n\t\tconst isIntercept = tap == \"intercept\";\r\n\t\tswitch(`${tap} ${type}`) {\r\n\t\t\tcase \"multiple-async async\":\r\n\t\t\t\treturn `function(${argsWithCallback}) {\r\n\t\t\t\t\tconst _fns = this._x;\r\n\t\t\t\t\tlet _remaining = _fns.length;\r\n\t\t\t\t\tconst _handler = (_err) => {\r\n\t\t\t\t\t\tif(_err && _remaining > 0) {\r\n\t\t\t\t\t\t\t_remaining = -1;\r\n\t\t\t\t\t\t\t_callback(_err);\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(--_remaining === 0) {\r\n\t\t\t\t\t\t\t_callback();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t\tfor(let _i = 0; _i < _fns.length; _i++) {\r\n\t\t\t\t\t\t_fns[_i](${argsWithComma}_handler);\r\n\t\t\t\t\t}\r\n\t\t\t\t}`;\r\n\t\t\tcase \"multiple-async promise\":\r\n\t\t\t\treturn `function(${args}) {\r\n\t\t\t\t\treturn new Promise((_resolve, _reject) => {\r\n\t\t\t\t\t\tconst _fns = this._x;\r\n\t\t\t\t\t\tlet _remaining = _fns.length;\r\n\t\t\t\t\t\tconst _handler = (_err) => {\r\n\t\t\t\t\t\t\tif(_err && _remaining > 0) {\r\n\t\t\t\t\t\t\t\t_remaining = -1;\r\n\t\t\t\t\t\t\t\t_reject(_err);\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(--_remaining === 0) {\r\n\t\t\t\t\t\t\t\t_resolve();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tfor(let _i = 0; _i < _fns.length; _i++) {\r\n\t\t\t\t\t\t\t_fns[_i](${argsWithComma}_handler);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}`;\r\n\t\t\tcase \"multiple-promise async\":\r\n\t\t\t\treturn `function(${argsWithCallback}) {\r\n\t\t\t\t\tconst _fns = this._x;\r\n\t\t\t\t\tlet _remaining = _fns.length;\r\n\t\t\t\t\tconst _handler = () => {\r\n\t\t\t\t\t\tif(--_remaining === 0) {\r\n\t\t\t\t\t\t\t_callback();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst _handlerErr = (_err) => {\r\n\t\t\t\t\t\tif(_remaining > 0) {\r\n\t\t\t\t\t\t\t_remaining = -1;\r\n\t\t\t\t\t\t\t_callback(_err);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(let _i = 0; _i < _fns.length; _i++) {\r\n\t\t\t\t\t\tPromise.resolve(_fns[_i](${args})).then(_handler, _handlerErr);\r\n\t\t\t\t\t}\r\n\t\t\t\t}`;\r\n\t\t\tcase \"multiple-promise promise\":\r\n\t\t\t\treturn `function(${args}) {\r\n\t\t\t\t\tconst _fns = this._x;\r\n\t\t\t\t\treturn Promise.all(_fns.map(_fn => _fn(${args}))).then(() => {});\r\n\t\t\t\t}`;\r\n\t\t\tcase \"multiple async\":\r\n\t\t\tcase \"intercept async\":\r\n\t\t\t\treturn `function(${argsWithCallback}) {\r\n\t\t\t\t\tconst _taps = this._x;\r\n\t\t\t\t\t${isIntercept ? `const _intercept = this.interceptors;\r\n\t\t\t\t\t\tfor(let _j = 0; _j < _intercept.length; _j++)\r\n\t\t\t\t\t\t\t_intercept[_j].call(${args});\r\n\t\t\t\t\t` : \"\"}\r\n\t\t\t\t\tlet _remaining = _taps.length;\r\n\t\t\t\t\tconst _handler = (_err) => {\r\n\t\t\t\t\t\tif(_err && _remaining > 0) {\r\n\t\t\t\t\t\t\t_remaining = -1;\r\n\t\t\t\t\t\t\t_callback(_err);\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(--_remaining === 0) {\r\n\t\t\t\t\t\t\t_callback();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t\tconst _handlerSuccess = () => {\r\n\t\t\t\t\t\tif(--_remaining === 0) {\r\n\t\t\t\t\t\t\t_callback();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst _handlerErr = (_err) => {\r\n\t\t\t\t\t\tif(_remaining > 0) {\r\n\t\t\t\t\t\t\t_remaining = -1;\r\n\t\t\t\t\t\t\t_callback(_err);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(let _i = 0; _i < _taps.length; _i++) {\r\n\t\t\t\t\t\t${isIntercept ? `let _tap = _taps[_i];\r\n\t\t\t\t\t\tfor(let _j = 0; _j < _intercept.length; _j++)\r\n\t\t\t\t\t\t\t_tap = _intercept[_j].tap(_tap);\r\n\t\t\t\t\t\t` : `const _tap = _taps[_i];`}\r\n\t\t\t\t\t\tswitch(_tap.type) {\r\n\t\t\t\t\t\t\tcase \"sync\":\r\n\t\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\t\t_tap.fn(${args});\r\n\t\t\t\t\t\t\t\t} catch(_err) {\r\n\t\t\t\t\t\t\t\t\t_handlerErr(_err);\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t_handlerSuccess();\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase \"async\":\r\n\t\t\t\t\t\t\t\t_tap.fn(${argsWithComma}_handler);\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase \"promise\":\r\n\t\t\t\t\t\t\t\tPromise.resolve(_tap.fn(${args})).then(_handlerSuccess, _handlerErr);\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}`;\r\n\t\t\tcase \"multiple promise\":\r\n\t\t\tcase \"intercept promise\":\r\n\t\t\t\treturn `function(${args}) {\r\n\t\t\t\t\tconst _taps = this._x;\r\n\t\t\t\t\t${isIntercept ? `const _intercept = this.interceptors;\r\n\t\t\t\t\tfor(let _j = 0; _j < _intercept.length; _j++)\r\n\t\t\t\t\t\t_intercept[_j].call(${args});\r\n\t\t\t\t\t` : \"\"}\r\n\t\t\t\t\tlet _earlyAbort = false;\r\n\t\t\t\t\treturn Promise.all(_taps.map(_tap => {\r\n\t\t\t\t\t\tif(_earlyAbort) return;\r\n\t\t\t\t\t\t${isIntercept ? `for(let _j = 0; _j < _intercept.length; _j++)\r\n\t\t\t\t\t\t\t_tap = _intercept[_j].tap(_tap);\r\n\t\t\t\t\t\t` : \"\"}\r\n\t\t\t\t\t\tswitch(_tap.type) {\r\n\t\t\t\t\t\t\tcase \"sync\":\r\n\t\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\t\t_tap.fn(${args});\r\n\t\t\t\t\t\t\t\t} catch(_err) {\r\n\t\t\t\t\t\t\t\t\t_earlyAbort = true;\r\n\t\t\t\t\t\t\t\t\treturn Promise.reject(_err);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn Promise.resolve();\r\n\t\t\t\t\t\t\t\tcase \"async\":\r\n\t\t\t\t\t\t\t\treturn new Promise((_resolve, _reject) => {\r\n\t\t\t\t\t\t\t\t\t_tap.fn(${argsWithComma}_err => {\r\n\t\t\t\t\t\t\t\t\t\tif(_err) {\r\n\t\t\t\t\t\t\t\t\t\t\t_earlyAbort = true;\r\n\t\t\t\t\t\t\t\t\t\t\t_reject(_err);\r\n\t\t\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t_resolve();\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase \"promise\":\r\n\t\t\t\t\t\t\t\treturn _tap.fn(${args});\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})).then(() => {});\r\n\t\t\t\t}`;\r\n\t\t\t/* istanbul ignore next */\r\n\t\t\tdefault:\r\n\t\t\t\t/* istanbul ignore next */\r\n\t\t\t\tthrow new Error(`Unsupported tap '${tap}' or type '${type}'`);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nmodule.exports = AsyncParallelHook;\r\n","import Debug from 'debug'\nimport fs from 'fs'\nimport _ from 'lodash'\nimport scErrors from 'sc-errors'\nimport { SocketCluster } from 'socketcluster'\nimport options from './common/options';\nimport Tapable from 'tapable'\nimport AsyncParallelHook from 'tapable/lib/AsyncParallelHook'\n\nconst TimeoutError = scErrors.TimeoutError\nconst debug = Debug('vuxtraBoot:')\ndebug.color = 5\n\n// SOCKET SERVER DEFAULT OPTIONS PROCESSING\n\n\nvar SOCKETCLUSTER_CONTROLLER_BOOT_TIMEOUT = Number(process.env.SOCKETCLUSTER_CONTROLLER_BOOT_TIMEOUT) || 10000\n\nexport const startupStatus  = {\n    init: 'INIT',\n    startDev: 'START_DEV',\n    startSocketserver: 'START_SOCKET_SERVER',\n    readySocketserver: 'READY_SOCKET_SERVER',\n    failSocketserver: 'FAIL_SOCKET_SERVER',\n    readySocketserverWorkerCluster: 'READY_SOCKET_SERVER_WORKER_CLUSTER',\n    vuxtraBuilt: 'VUXTRA_BUILT',\n    nuxtBuilt: 'NUXT_BUILT',\n    vuxtraStarted: 'VUXTRA_STARTED'\n}\n\n\nexport default class VuxtraBoot extends Tapable {\n    constructor (_options = {}) {\n        super()\n        // Apply defaults\n        this.options = options.from(_options)\n\n        this.hooks = {\n            startDev: new AsyncParallelHook([\"VuxtraBoot\"]),\n            startSocketserver: new AsyncParallelHook([\"VuxtraBoot\"]),\n            readySocketserver: new AsyncParallelHook([\"VuxtraBoot\"]),\n            failSocketserver: new AsyncParallelHook(['VuxtraBoot','data']),\n            readySocketserverWorkerCluster: new AsyncParallelHook(['VuxtraBoot']),\n            vuxtraBuilt: new AsyncParallelHook(['VuxtraBoot']),\n            nuxtBuilt: new AsyncParallelHook(['VuxtraBoot']),\n            vuxtraStarted: new AsyncParallelHook(['VuxtraBoot'])\n        };\n\n        this.startupStatus = 'INIT'\n\n    }\n\n    async startDev (port = 3000, host = 'localhost', nuxtDev = true) {\n        this.hooks.startDev.promise(this);\n        this.startupStatus = startupStatus.startDev\n\n        // socketcluster dev setup\n        this.options.socketcluster.environment = 'dev'\n\n        if (typeof this.options.nuxt.rootDir !== 'string') {\n            this.options.nuxt.rootDir = this.options.rootDir\n        }\n\n        // Force development mode for add hot reloading and watching changes\n        this.options.nuxt.dev = nuxtDev\n\n        // Nuxt Mode\n        this.options.nuxt.mode = 'universal'\n\n        this.startSocketCluster(port, host)\n    }\n\n\n\n    startProd (port = 3000, host = 'localhost') {\n\n    }\n\n    startSocketCluster (port = 3000, host= 'localhost') {\n\n        debug(`Starting: SOCKETCLUSTER on ${host}:${port}`)\n        var optionsControllerPath = process.env.SOCKETCLUSTER_OPTIONS_CONTROLLER\n        var masterControllerPath =  __dirname + '/sccMaster.js'\n        var workerControllerPath =  __dirname + '/sccWorker.js';\n        var brokerControllerPath =  __dirname + '/sccBroker.js';\n        var initControllerPath = process.env.SOCKETCLUSTER_INIT_CONTROLLER;\n        var workerClusterControllerPath = process.env.SOCKETCLUSTER_WORKERCLUSTER_CONTROLLER;\n\n        // kind of hackish way - attcah full config to options to be passed to worker\n        this.options.socketcluster.__full_deep_temp_options =  _.cloneDeep(this.options)\n\n        var fileExists = function (filePath, callback) {\n            fs.access(filePath, fs.constants.F_OK, (err) => {\n                callback(!err)\n            })\n        }\n\n        var runMasterController = function (socketCluster, filePath) {\n            var masterController = require(filePath)\n            masterController.run(socketCluster)\n\n        }\n\n        var launch = (startOptions) => {\n            var socketCluster = new SocketCluster(startOptions)\n            var masterController\n\n\n            this.hooks.startSocketserver.promise(this);\n            this.startupStatus = startupStatus.startSocketserver\n\n            socketCluster.on('ready',  (workerClusterInfo) => {\n                this.hooks.readySocketserver.promise(this)\n                this.startupStatus = startupStatus.readySocketserver\n            })\n\n            socketCluster.on('workerClusterReady',  (workerClusterInfo) => {\n                this.hooks.readySocketserverWorkerCluster.promise(this)\n                this.startupStatus = startupStatus.readySocketserverWorkerCluster\n            })\n\n            socketCluster.on('fail',  (workerClusterInfo) => {\n                this.hooks.failSocketserver.promise(this)\n                this.startupStatus = startupStatus.failSocketserver\n            })\n\n            socketCluster.on('workerMessage',  (id, data) => {\n                if (typeof data.type !== 'undefined') {\n                    if (data.type === 'event') {\n                        switch(data.subtype) {\n                            case 'vuxtraBuilt':\n                                this.hooks.vuxtraBuilt.promise(this)\n                                this.startupStatus = startupStatus.vuxtraBuilt\n                                break;\n                            case 'nuxtBuilt':\n                                this.hooks.nuxtBuilt.promise(this)\n                                this.startupStatus = startupStatus.nuxtBuilt\n                        }\n                    } else if (data.type === 'error') {\n                        this.hooks.failSocketserver.promise(this, data)\n                        this.startupStatus = startupStatus.failSocketserver\n                    }\n                }\n            })\n\n            if (masterControllerPath) {\n                runMasterController(socketCluster, masterControllerPath)\n            } else {\n                var defaultMasterControllerPath =  './sccMaster.js'\n                fileExists(defaultMasterControllerPath, (exists) => {\n                    if (exists) {\n                        runMasterController(socketCluster, defaultMasterControllerPath)\n                    }\n                })\n            }\n        }\n\n        var start =  () => {\n            if (optionsControllerPath) {\n                var optionsController = require(optionsControllerPath)\n                optionsController.run(this.options.socketcluster, launch)\n            } else {\n                launch(this.options.socketcluster)\n            }\n        }\n\n        var bootCheckInterval = Number(process.env.SOCKETCLUSTER_BOOT_CHECK_INTERVAL) || 200\n        var bootStartTime = Date.now()\n\n// Detect when Docker volumes are ready.\n        var startWhenFileIsReady = (filePath) => {\n            return new Promise((resolve, reject) => {\n                if (!filePath) {\n                    resolve()\n                    return\n                }\n                var checkIsReady = () => {\n                    var now = Date.now()\n\n                    fileExists(filePath, (exists) => {\n                        if (exists) {\n                            resolve()\n                        } else {\n                            if (now - bootStartTime >= SOCKETCLUSTER_CONTROLLER_BOOT_TIMEOUT) {\n                                var errorMessage = `Could not locate a controller file at path ${filePath} ` +\n                                    `before SOCKETCLUSTER_CONTROLLER_BOOT_TIMEOUT`\n                                var volumeBootTimeoutError = new TimeoutError(errorMessage)\n                                reject(volumeBootTimeoutError)\n                            } else {\n                                setTimeout(checkIsReady, bootCheckInterval)\n                            }\n                        }\n                    })\n                }\n                checkIsReady()\n            })\n        }\n\n        var filesReadyPromises = [\n            startWhenFileIsReady(optionsControllerPath),\n            startWhenFileIsReady(masterControllerPath),\n            startWhenFileIsReady(workerControllerPath),\n            startWhenFileIsReady(brokerControllerPath),\n            startWhenFileIsReady(initControllerPath),\n            startWhenFileIsReady(workerClusterControllerPath)\n        ]\n        Promise.all(filesReadyPromises)\n            .then(() => {\n                start()\n            })\n            .catch((err) => {\n                console.error(err.stack)\n                process.exit(1)\n            })\n\n\n    }\n\n}"],"names":["defaultOptionsObj","Number","process","env","SOCKETCLUSTER_WORKERS","SOCKETCLUSTER_BROKERS","SOCKETCLUSTER_PORT","SOCKETCLUSTER_WS_ENGINE","SOCKETCLUSTER_APP_NAME","__dirname","SOCKETCLUSTER_INIT_CONTROLLER","SOCKETCLUSTER_WORKERCLUSTER_CONTROLLER","SOCKETCLUSTER_SOCKET_CHANNEL_LIMIT","SCC_STATE_SERVER_HOST","SCC_STATE_SERVER_PORT","SCC_AUTH_KEY","SCC_INSTANCE_IP","SCC_INSTANCE_IP_FAMILY","SCC_STATE_SERVER_CONNECT_TIMEOUT","SCC_STATE_SERVER_ACK_TIMEOUT","SCC_STATE_SERVER_RECONNECT_RANDOMNESS","ENV","NODE_ENV","undefined","Options","from","_options","options","Object","assign","defaultsDeep","defaultOptions","vuxtra","srcDir","rootDir","hasValue","v","cwd","resolve","modulesDir","buildDir","cacheDir","Hook","TimeoutError","scErrors","debug","Debug","color","SOCKETCLUSTER_CONTROLLER_BOOT_TIMEOUT","startupStatus","VuxtraBoot","Tapable","hooks","AsyncParallelHook","port","host","nuxtDev","startDev","promise","socketcluster","environment","nuxt","dev","mode","startSocketCluster","optionsControllerPath","SOCKETCLUSTER_OPTIONS_CONTROLLER","masterControllerPath","workerControllerPath","brokerControllerPath","initControllerPath","workerClusterControllerPath","__full_deep_temp_options","_","cloneDeep","fileExists","filePath","callback","access","fs","constants","F_OK","err","runMasterController","socketCluster","masterController","require","run","launch","startOptions","SocketCluster","startSocketserver","on","workerClusterInfo","readySocketserver","readySocketserverWorkerCluster","failSocketserver","id","data","type","subtype","vuxtraBuilt","nuxtBuilt","defaultMasterControllerPath","exists","start","optionsController","bootCheckInterval","SOCKETCLUSTER_BOOT_CHECK_INTERVAL","bootStartTime","Date","now","startWhenFileIsReady","Promise","reject","checkIsReady","errorMessage","volumeBootTimeoutError","filesReadyPromises","all","then","catch","error","stack","exit"],"mappings":"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"}